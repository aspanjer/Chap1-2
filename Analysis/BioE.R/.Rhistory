EG.EX.Equation=3, Resp.SDA.Equation=2, Pred.ED.Equation=2)
#Easiest to set your working directory to where the source code is stored. Simple to set the working directory
#in R-Studio---On main menue---Session-->Set Working Directory--->To Source File Location.
write.csv(x=Sim.1, file="10AE.csv")
Sim.1 <- RUN.FISH.BIOENERGETICS("12AE.txt", Weight.Initial=.2,
Weight.Final=2.63, Spawning.Day=0, Gonad.Loss=0, Con.Equation=3,
EG.EX.Equation=3, Resp.SDA.Equation=2, Pred.ED.Equation=2)
#Easiest to set your working directory to where the source code is stored. Simple to set the working directory
#in R-Studio---On main menue---Session-->Set Working Directory--->To Source File Location.
write.csv(x=Sim.1, file="12AE.csv")
Sim.1 <- RUN.FISH.BIOENERGETICS("19AE.txt", Weight.Initial=.2,
Weight.Final=5.19, Spawning.Day=0, Gonad.Loss=0, Con.Equation=3,
EG.EX.Equation=3, Resp.SDA.Equation=2, Pred.ED.Equation=2)
#Easiest to set your working directory to where the source code is stored. Simple to set the working directory
#in R-Studio---On main menue---Session-->Set Working Directory--->To Source File Location.
write.csv(x=Sim.1, file="19AE.csv")
setwd("~/Documents/Current Projects/BioE.R/Input files for BioE")
setwd("~/Documents/Current Projects/BioE.R")
coho.p<-read.csv(file="Model.results_coho.csv", header=T)
?boxplot
setwd("~/Documents/Current Projects/BioE.R/Input files for BioE/Longfellow")
Sim.1 <- RUN.FISH.BIOENERGETICS("1AL.txt", Weight.Initial=.2,
+                                 Weight.Final=7.46, Spawning.Day=0, Gonad.Loss=0, Con.Equation=3,
+                                 EG.EX.Equation=3, Resp.SDA.Equation=2, Pred.ED.Equation=2)
Sim.1 <- RUN.FISH.BIOENERGETICS("1AL.csv.txt", Weight.Initial=.2,
Weight.Final=7.46, Spawning.Day=0, Gonad.Loss=0, Con.Equation=3,
EG.EX.Equation=3, Resp.SDA.Equation=2, Pred.ED.Equation=2)
Sim.1 <- RUN.FISH.BIOENERGETICS("1AL.txt", Weight.Initial=.2,
Weight.Final=7.46, Spawning.Day=0, Gonad.Loss=0, Con.Equation=3,
EG.EX.Equation=3, Resp.SDA.Equation=2, Pred.ED.Equation=2)
Sim.1 <- RUN.FISH.BIOENERGETICS("2AL.txt", Weight.Initial=.2,
Weight.Final=6.4, Spawning.Day=0, Gonad.Loss=0, Con.Equation=3,
EG.EX.Equation=3, Resp.SDA.Equation=2, Pred.ED.Equation=2)
Sim.1 <- RUN.FISH.BIOENERGETICS("3AL.txt", Weight.Initial=.2,
Weight.Final=10, Spawning.Day=0, Gonad.Loss=0, Con.Equation=3,
EG.EX.Equation=3, Resp.SDA.Equation=2, Pred.ED.Equation=2)
Sim.1 <- RUN.FISH.BIOENERGETICS("4AL.txt", Weight.Initial=.2,
Weight.Final=6.11, Spawning.Day=0, Gonad.Loss=0, Con.Equation=3,
EG.EX.Equation=3, Resp.SDA.Equation=2, Pred.ED.Equation=2)
Sim.1 <- RUN.FISH.BIOENERGETICS("5AL.txt", Weight.Initial=.2,
Weight.Final=8.65, Spawning.Day=0, Gonad.Loss=0, Con.Equation=3,
EG.EX.Equation=3, Resp.SDA.Equation=2, Pred.ED.Equation=2)
Sim.1 <- RUN.FISH.BIOENERGETICS("6AL.txt", Weight.Initial=.2,
Weight.Final=12.41, Spawning.Day=0, Gonad.Loss=0, Con.Equation=3,
EG.EX.Equation=3, Resp.SDA.Equation=2, Pred.ED.Equation=2)
Sim.1 <- RUN.FISH.BIOENERGETICS("7AL.txt", Weight.Initial=.2,
Weight.Final=4.39, Spawning.Day=0, Gonad.Loss=0, Con.Equation=3,
EG.EX.Equation=3, Resp.SDA.Equation=2, Pred.ED.Equation=2)
Sim.1 <- RUN.FISH.BIOENERGETICS("8AL.txt", Weight.Initial=.2,
Weight.Final=7.9, Spawning.Day=0, Gonad.Loss=0, Con.Equation=3,
EG.EX.Equation=3, Resp.SDA.Equation=2, Pred.ED.Equation=2)
Sim.1 <- RUN.FISH.BIOENERGETICS("9AL.txt", Weight.Initial=.2,
Weight.Final=9.27, Spawning.Day=0, Gonad.Loss=0, Con.Equation=3,
EG.EX.Equation=3, Resp.SDA.Equation=2, Pred.ED.Equation=2)
Sim.1 <- RUN.FISH.BIOENERGETICS("10AL.txt", Weight.Initial=.2,
Weight.Final=8.3, Spawning.Day=0, Gonad.Loss=0, Con.Equation=3,
EG.EX.Equation=3, Resp.SDA.Equation=2, Pred.ED.Equation=2)
Sim.1 <- RUN.FISH.BIOENERGETICS("9AL.txt", Weight.Initial=.2,
Weight.Final=9.27, Spawning.Day=0, Gonad.Loss=0, Con.Equation=3,
EG.EX.Equation=3, Resp.SDA.Equation=2, Pred.ED.Equation=2)
Sim.1 <- RUN.FISH.BIOENERGETICS("10AL.txt", Weight.Initial=.2,
Weight.Final=8.3, Spawning.Day=0, Gonad.Loss=0, Con.Equation=3,
EG.EX.Equation=3, Resp.SDA.Equation=2, Pred.ED.Equation=2)
coho.p.J<-read.csv(file="Model_results_coho_J.csv", header=T)
setwd("~/Documents/Current Projects/BioE.R")
coho.p.J<-read.csv(file="Model_results_coho_J.csv", header=T)
boxplot(coho.p.J$p.value~coho.p.J$site.level, names=coho.9, ylab="% of maximum consumption", xaxs="i")
coho.9<-c("Coulter","E.F. Dariy","Issaquah","Harris","May","Woodland","Jenkins","Longfellow","Swamp")
boxplot(coho.p.J$p.value~coho.p.J$site.level, names=coho.9, ylab="% of maximum consumption", xaxs="i")
coho.p.S<-read.csv(file="Model_results_coho_S.csv", header=T)
coho.6<-c("Coulter","Issaquah", "Harris", "May", "Jenkins", "Swamp")
boxplot(coho.p.S$p.value~coho.p.S$site.level, names=coho.6, ylab="% of maximum consumption", xaxs="i")
View(RUN.FISH.BIOENERGETICS)
boxplot(coho.p.J$p.value~coho.p.J$site.level, names=coho.9, ylab="% of maximum consumption", xaxs="i", cex=2)
boxplot(coho.p.J$p.value~coho.p.J$site.level, names=coho.9, ylab="% of maximum consumption", xaxs="i", cex=2)
boxplot(coho.p.J$p.value~coho.p.J$site.level, names=coho.9, ylab="% of maximum consumption", xaxs="i", cex=3)
?boxplot
boxplot(coho.p.J$p.value~coho.p.J$site.level, names=coho.9, ylab="% of maximum consumption", xaxs="i", cex.names=2)
boxplot(coho.p.J$p.value~coho.p.J$site.level, names=coho.9, ylab="% of maximum consumption", xaxs="i", cex.names=5)
par(cex.lab=1.5)
boxplot(coho.p.J$p.value~coho.p.J$site.level, names=coho.9, ylab="% of maximum consumption", xaxs="i", cex.names=5)
par(cex.lab=1.5, cex.names=1.5)
par(cex.lab=1.5, cex.axis=1.5)
boxplot(coho.p.J$p.value~coho.p.J$site.level, names=coho.9, ylab="% of maximum consumption", xaxs="i", cex.names=5)
boxplot(coho.p.J$p.value~coho.p.J$site.level, names=coho.9, ylab="% of maximum consumption", xaxs="i", cex.names=5)
par(cex.lab=1.5, cex.axis=2)
boxplot(coho.p.J$p.value~coho.p.J$site.level, names=coho.9, ylab="% of maximum consumption", xaxs="i", cex.names=5)
par(cex.lab=1.5, cex.axis=1.7)
boxplot(coho.p.J$p.value~coho.p.J$site.level, names=coho.9, ylab="% of maximum consumption", xaxs="i", cex.names=5)
View(coho.p)
coho.p.J<-read.csv(file="Model_results_coho_J.csv", header=T)
par(cex.lab=1.5, cex.axis=1.7)
boxplot(coho.p.J$p.value~coho.p.J$site.level, names=coho.9, ylab="% of maximum consumption", xaxs="i", cex.names=5)
coho.p.J<-read.csv(file="Model_results_coho_J.csv", header=T)
?boxplot
par(cex.lab=1.5, cex.axis=1.7)
boxplot(coho.p.J$p.value~coho.p.J$site.level, names=coho.9, ylab="% of maximum consumption", xaxs="i", cex.names=5)
coho.9<-c("Coulter","E.F. Dariy","Issaquah","Harris","May","Woodland","Jenkins","Longfellow","Swamp")
coho.9<-c("Coulter","E.F. Dariy","Issaquah","Harris","Church","May","Woodland","Jenkins","Longfellow","Swamp")
boxplot(coho.p.J$p.value~coho.p.J$site.level, names=coho.9, ylab="% of maximum consumption", xaxs="i", cex.names=5)
boxplot(coho.p.S$p.value~coho.p.S$site.level, names=coho.6, ylab="% of maximum consumption", xaxs="i")
coho.6<-c("Coulter","Issaquah", "Harris", "May", "Jenkins", "Swamp")
View(coho.p.J)
boxplot(coho.p.J$Final.Weight~coho.p.J$site.level, names=coho.9, ylab="% of maximum consumption", xaxs="i", cex.names=5, col="blue")
boxplot(coho.p.J$Final.Weight~coho.p.J$site.level, names=coho.9, ylab="Final Weight (g)", xaxs="i", cex.names=5, col="blue")
boxplot(coho.p.S$Final.Weight~coho.p.S$site.level, names=coho.6, ylab="% of maximum consumption", xaxs="i", col="blue")
glm.test<-read.csv(file="glm.csv")
glm1<-glm(glm.test$Average.of.p.value~glm.test$Drift_Den + glm.test$Salmonids)
summary(glm1)
glm1<-glm(glm.test$Average.of.p.value~glm.test$Drift_Den*1000 + glm.test$Salmonids)
glm1<-glm(glm.test$Average.of.p.value~glm.test$Drift_Den + glm.test$Salmonids family=poisson)
glm1<-glm(glm.test$Average.of.p.value~glm.test$Drift_Den + glm.test$Salmonids, family=poisson)
This r script creates Chinook temperature-dependent growth curves for a given combination of
#consumer weight, consumer energy density (J/g), feeding  rate (P-value or %Cmax), and prey energy
#density (J/g).
#Define Chinook-specific parameters:
#Consumption related parameters (user defined):
CA <- 0.303
CB <- -0.275
CQ <- 5
CTO <- 15
CTM <- 20.93         #(Source: Plumb & Moffitt 2015)
CTL <- 24.05         #(Source: Plumb & Moffitt 2015)
CK1 <- 0.36
CK4 <- 0.53          #(Source: Plumb & Moffitt 2015)
#Respiration related parameters (user defined):
RA <- 0.00264
RB <- -0.217
RQ <- 0.06818
RTO <- 0.0234
RTM <- 0
RTL <- 25
RK1 <- 1
RK4 <- 0.13
ACT <- 9.7
BACT <- 0.0405
SDA <- 0.172
OxyConv <- 13560 #J/gram of O2 in respiration conversions (Elliot and Davidson 1975).
#Egestion and excretion parameters (user defined):
FA <- 0.212
FB <- -0.222
FG <- 0.631
UA <- 0.0314
UB <- 0.58
UG <- -0.299
#Define range of temperatures over which to estimate growth
Temp <- seq(from = 1, to = 25, by = 1)
#Define function TempGrowth that creates Chinook temperature-dependent growth curves for a given
#combination of consumer weight ("cons.wt"), consumer energy density ("cons.ED"; J/g), feeding
#rate ("pval"; P-value or %Cmax), and prey energy density ("prey.ED"; J/g).
TempGrowth <- function(cons.wt, cons.ED, pval, prey.ED) {
#Define empty vector of length (length(Temp)) for growth values at each temperature
Growth <- vector(length = length(Temp))
#Define empty vector of length (length(Temp)) for consumption values at each temperature
Consumption <- vector(length = length(Temp))
#Define empty vector of length (length(Temp)) for egestion and excretion values at each
#temperature
Egestion <- vector(length = length(Temp))
Excretion <- vector(length = length(Temp))
#Define empty vector of length (length(Temp)) for SDAction and respiration values at each
#temperature
SDAction <- vector(length = length(Temp))
Respiration <- vector(length = length(Temp))
#Calculate Consumption at each temperature and store in Consumption vector
for(i in 1:length(Temp)) {
G1 <- (1/(CTO-CQ))*log((0.98*(1-CK1))/(CK1*0.02))
G2 <- (1/(CTL-CTM))*log((0.98*(1-CK4))/(CK4*0.02))
L1 <- (exp(G1*(Temp[i]-CQ)))
L2 <- (exp(G2*(CTL-Temp[i])))
KA <- (CK1*L1)/(1+CK1*(L1 - 1))
KB <- (CK4*L2)/(1+CK4*(L2 - 1))
ft.con <- (KA*KB)
Consumption[i] <- (CA*cons.wt^CB)*pval*ft.con
}
#Calculate Egestion at each temperature and store in Egestion and Excretion vectors
for (i in 1:length(Temp)) {
Egestion[i] <- FA*(Temp[i]^FB)*exp(FG*pval)*Consumption[i]
Excretion[i] <- UA*(Temp[i]^UB)*exp(UG*pval)*(Consumption[i]-Egestion[i])
}
#Calculate SDAction and Respiration values at each temperature and store in SDAction and
#Respiration vectors
for (i in 1:length(Temp)) {
ifelse(Temp[i] > RTL, VEL <- RK1*cons.wt^RK4, VEL <- ACT*(cons.wt^RK4)*exp(BACT*Temp[i]))
ft.metabolism <- exp(RQ*Temp[i])
ACTIVITY <- exp(RTO*VEL)
Respiration[i] <- RA*(cons.wt^RB)*ft.metabolism*ACTIVITY #Units --> Specific (g O2/g/d).
SDAction[i] <- SDA*(Consumption[i]-Egestion[i]) #Units --> Specific (g/g/d)
}
Growth <- ((Consumption*prey.ED) - (((Egestion+Excretion+SDAction)*prey.ED) + (Respiration*OxyConv)))/cons.ED
return(data.frame(Temp, Growth, Consumption, Excretion, Egestion, SDAction, Respiration))
}
#Calculate Temp-dependent Growth curves for different P-value/Prey ED combinations
#Low PreyED = 3700
LowC.3 <- TempGrowth(cons.wt = 10, cons.ED = 4085, pval = 0.3, prey.ED = 3700)
LowC.5 <- TempGrowth(cons.wt = 10, cons.ED = 4085, pval = 0.5, prey.ED = 3700)
LowC.7 <- TempGrowth(cons.wt = 10, cons.ED = 4085, pval = 0.7, prey.ED = 3700)
#Mid PreyED = 4200
MidC.3 <- TempGrowth(cons.wt = 10, cons.ED = 4085, pval = 0.3, prey.ED = 4200)
MidC.5 <- TempGrowth(cons.wt = 10, cons.ED = 4085, pval = 0.5, prey.ED = 4200)
MidC.7 <- TempGrowth(cons.wt = 10, cons.ED = 4085, pval = 0.7, prey.ED = 4200)
#High PreyED = 5200
HighC.3 <- TempGrowth(cons.wt = 10, cons.ED = 4085, pval = 0.3, prey.ED = 5200)
HighC.5 <- TempGrowth(cons.wt = 10, cons.ED = 4085, pval = 0.5, prey.ED = 5200)
HighC.7 <- TempGrowth(cons.wt = 10, cons.ED = 4085, pval = 0.7, prey.ED = 5200)
#Plot Temp-dependent growth curves
par(mfrow=c(3,1), mar = c(0,0,0,0), oma = c(5,5,4,1), cex.axis = 1.3)
#High PreyED
matplot(x = HighC.3$Temp, y = HighC.3$Growth, pch = 20, type = "o", xlim = c(0,25),
ylim = c(0,0.06), xaxs = "i", yaxs = "i", xaxt = "n", yaxt = "n", col = "blue")
axis(side = 2, at = c(0.02, 0.03, 0.04, 0.05, 0.06))
matplot(x = HighC.5$Temp, y = HighC.5$Growth, pch = 15, type = "o", add = T,
col = "green2")
matplot(x = HighC.7$Temp, y = HighC.7$Growth, pch = 17, type = "o", add = T, col = "red")
polygon(x = c(9,9,13,13), y = c(0,0.06,0.06,0), col = (rgb(red = .2, green = .3,
blue = .4, alpha = .4)))
legend("topright", legend = "5200 J/g Diet", bty = "n", cex = 1.3)
#Mid PreyED
matplot(x = MidC.3$Temp, y = MidC.3$Growth, pch = 20, type = "o", xlim = c(0,25),
ylim = c(0,0.06), xaxs = "i", yaxs = "i", xaxt = "n", yaxt = "n", col = "blue")
axis(side = 2, at = c(0.02, 0.03, 0.04, 0.05, 0.06))
matplot(x = MidC.5$Temp, y = MidC.5$Growth, pch = 15, type = "o", add = T, col = "green2")
matplot(x = MidC.7$Temp, y = MidC.7$Growth, pch = 17, type = "o", add = T, col = "red")
polygon(x = c(9,9,13,13), y = c(0,0.06,0.06,0), col = (rgb(red = .2, green = .3,
blue = .4, alpha = .4)))
legend("topright", legend = "4200 J/g Diet", bty = "n", cex = 1.3)
#Low PreyED
matplot(x = LowC.3$Temp, y = LowC.3$Growth, pch = 20, type = "o", xlim = c(0,25),
ylim = c(0,0.06), xaxs = "i", yaxs = "i", col = "blue")
matplot(x = LowC.5$Temp, y = LowC.5$Growth, pch = 15, type = "o", add = T, col = "green2")
matplot(x = LowC.7$Temp, y = LowC.7$Growth, pch = 17, type = "o", add = T, col = "red")
polygon(x = c(9,9,13,13), y = c(0,0.06,0.06,0), col = (rgb(red = .2, green = .3,
blue = .4, alpha = .4)))
legend("topleft", legend = c("70% Cmax", "50% Cmax", "30% Cmax"), pch = c(17,15,20),
lty = 1, col = c("red", "green2", "blue"), bty = "n", cex = 1.3)
legend("topright", legend = "3700 J/g Diet", bty = "n", cex = 1.3)
mtext(text = "10g Chinook Growth Rates", side = 3, line = 1, outer = T, cex = 1.5)
mtext(text = "Growth Rate (g/g*d)", side = 2, line = 2.75, outer = T, cex = 1.2)
mtext(text = expression(paste("Temperature (", degree, "C)")), side = 1, line = 2.75, outer = T, cex = 1.2)
par(mfrow=c(1,1), mar = c(0,0,0,0), oma = c(5,5,4,1), cex.axis = 1.3)
#Mid PreyED
matplot(x = MidC.3$Temp, y = MidC.3$Growth, pch = 20, type = "o", xlim = c(0,25),
ylim = c(0,0.06), xaxs = "i", yaxs = "i", xaxt = "n", yaxt = "n", col = "blue")
axis(side = 2, at = c(0.02, 0.03, 0.04, 0.05, 0.06))
matplot(x = MidC.5$Temp, y = MidC.5$Growth, pch = 15, type = "o", add = T, col = "green2")
matplot(x = MidC.7$Temp, y = MidC.7$Growth, pch = 17, type = "o", add = T, col = "red")
polygon(x = c(9,9,13,13), y = c(0,0.06,0.06,0), col = (rgb(red = .2, green = .3,
blue = .4, alpha = .4)))
legend("topright", legend = "4200 J/g Diet", bty = "n", cex = 1.3)
mtext(text = "2g Coho Growth Rates", side = 3, line = 1, outer = T, cex = 1.5)
mtext(text = "Growth Rate (g/g*d)", side = 2, line = 2.75, outer = T, cex = 1.2)
mtext(text = expression(paste("Temperature (", degree, "C)")), side = 1, line = 2.75, outer = T, cex = 1.2)
#Mid PreyED
matplot(x = MidC.3$Temp, y = MidC.3$Growth, pch = 20, type = "o", xlim = c(0,25),
ylim = c(0,0.06), xaxs = "i", yaxs = "i", xaxt = "n", yaxt = "n", col = "blue")
axis(side = 2, at = c(0,0.02, 0.03, 0.04, 0.05, 0.06))
matplot(x = MidC.5$Temp, y = MidC.5$Growth, pch = 15, type = "o", add = T, col = "green2")
matplot(x = MidC.7$Temp, y = MidC.7$Growth, pch = 17, type = "o", add = T, col = "red")
polygon(x = c(9,9,13,13), y = c(0,0.06,0.06,0), col = (rgb(red = .2, green = .3,
blue = .4, alpha = .4)))
legend("topright", legend = "4200 J/g Diet", bty = "n", cex = 1.3)
#Mid PreyED
matplot(x = MidC.3$Temp, y = MidC.3$Growth, pch = 20, type = "o", xlim = c(0,25),
ylim = c(0,0.06), xaxs = "i", yaxs = "i", xaxt = "n", yaxt = "n", col = "blue")
axis(side = 2, at = c(0,0.1,0.02, 0.03, 0.04, 0.05, 0.06))
matplot(x = MidC.5$Temp, y = MidC.5$Growth, pch = 15, type = "o", add = T, col = "green2")
matplot(x = MidC.7$Temp, y = MidC.7$Growth, pch = 17, type = "o", add = T, col = "red")
polygon(x = c(9,9,13,13), y = c(0,0.06,0.06,0), col = (rgb(red = .2, green = .3,
blue = .4, alpha = .4)))
legend("topright", legend = "4200 J/g Diet", bty = "n", cex = 1.3)
#Mid PreyED
matplot(x = MidC.3$Temp, y = MidC.3$Growth, pch = 20, type = "o", xlim = c(0,25),
ylim = c(0,0.06), xaxs = "i", yaxs = "i", xaxt = "n", yaxt = "n", col = "blue")
axis(side = 2, at = c(0,0.1,0.02, 0.03, 0.04, 0.05, 0.06))
matplot(x = MidC.5$Temp, y = MidC.5$Growth, pch = 15, type = "o", add = T, col = "green2")
matplot(x = MidC.7$Temp, y = MidC.7$Growth, pch = 17, type = "o", add = T, col = "red")
polygon(x = c(9,9,13,13), y = c(0,0.06,0.06,0), col = (rgb(red = .2, green = .3,
blue = .4, alpha = .4)))
legend("topright", legend = "4200 J/g Diet", bty = "n", cex = 1.3)
#Mid PreyED
matplot(x = MidC.3$Temp, y = MidC.3$Growth, pch = 20, type = "o", xlim = c(0,25),
ylim = c(0,0.06), xaxs = "i", yaxs = "i", xaxt = "n", yaxt = "n", col = "blue")
axis(side = 2, at = c(0,0.01,0.02, 0.03, 0.04, 0.05, 0.06))
matplot(x = MidC.5$Temp, y = MidC.5$Growth, pch = 15, type = "o", add = T, col = "green2")
matplot(x = MidC.7$Temp, y = MidC.7$Growth, pch = 17, type = "o", add = T, col = "red")
polygon(x = c(9,9,13,13), y = c(0,0.06,0.06,0), col = (rgb(red = .2, green = .3,
blue = .4, alpha = .4)))
legend("topright", legend = "4200 J/g Diet", bty = "n", cex = 1.3)
mtext(text = "2g Coho Growth Rates", side = 3, line = 1, outer = T, cex = 1.5)
mtext(text = "Growth Rate (g/g*d)", side = 2, line = 2.75, outer = T, cex = 1.2)
mtext(text = expression(paste("Temperature (", degree, "C)")), side = 1, line = 2.75, outer = T, cex = 1.2)
#This r script creates Chinook temperature-dependent growth curves for a given combination of
#consumer weight, consumer energy density (J/g), feeding  rate (P-value or %Cmax), and prey energy
#density (J/g).
#Define Chinook-specific parameters:
#Consumption related parameters (user defined):
CA <- 0.303
CB <- -0.275
CQ <- 5
CTO <- 15
CTM <- 20.93         #(Source: Plumb & Moffitt 2015)
CTL <- 24.05         #(Source: Plumb & Moffitt 2015)
CK1 <- 0.36
CK4 <- 0.53          #(Source: Plumb & Moffitt 2015)
#Respiration related parameters (user defined):
RA <- 0.00264
RB <- -0.217
RQ <- 0.06818
RTO <- 0.0234
RTM <- 0
RTL <- 25
RK1 <- 1
RK4 <- 0.13
ACT <- 9.7
BACT <- 0.0405
SDA <- 0.172
OxyConv <- 13560 #J/gram of O2 in respiration conversions (Elliot and Davidson 1975).
#Egestion and excretion parameters (user defined):
FA <- 0.212
FB <- -0.222
FG <- 0.631
UA <- 0.0314
UB <- 0.58
UG <- -0.299
#Define range of temperatures over which to estimate growth
Temp <- seq(from = 1, to = 25, by = 1)
#Define function TempGrowth that creates Chinook temperature-dependent growth curves for a given
#combination of consumer weight ("cons.wt"), consumer energy density ("cons.ED"; J/g), feeding
#rate ("pval"; P-value or %Cmax), and prey energy density ("prey.ED"; J/g).
TempGrowth <- function(cons.wt, cons.ED, pval, prey.ED) {
#Define empty vector of length (length(Temp)) for growth values at each temperature
Growth <- vector(length = length(Temp))
#Define empty vector of length (length(Temp)) for consumption values at each temperature
Consumption <- vector(length = length(Temp))
#Define empty vector of length (length(Temp)) for egestion and excretion values at each
#temperature
Egestion <- vector(length = length(Temp))
Excretion <- vector(length = length(Temp))
#Define empty vector of length (length(Temp)) for SDAction and respiration values at each
#temperature
SDAction <- vector(length = length(Temp))
Respiration <- vector(length = length(Temp))
#Calculate Consumption at each temperature and store in Consumption vector
for(i in 1:length(Temp)) {
G1 <- (1/(CTO-CQ))*log((0.98*(1-CK1))/(CK1*0.02))
G2 <- (1/(CTL-CTM))*log((0.98*(1-CK4))/(CK4*0.02))
L1 <- (exp(G1*(Temp[i]-CQ)))
L2 <- (exp(G2*(CTL-Temp[i])))
KA <- (CK1*L1)/(1+CK1*(L1 - 1))
KB <- (CK4*L2)/(1+CK4*(L2 - 1))
ft.con <- (KA*KB)
Consumption[i] <- (CA*cons.wt^CB)*pval*ft.con
}
#Calculate Egestion at each temperature and store in Egestion and Excretion vectors
for (i in 1:length(Temp)) {
Egestion[i] <- FA*(Temp[i]^FB)*exp(FG*pval)*Consumption[i]
Excretion[i] <- UA*(Temp[i]^UB)*exp(UG*pval)*(Consumption[i]-Egestion[i])
}
#Calculate SDAction and Respiration values at each temperature and store in SDAction and
#Respiration vectors
for (i in 1:length(Temp)) {
ifelse(Temp[i] > RTL, VEL <- RK1*cons.wt^RK4, VEL <- ACT*(cons.wt^RK4)*exp(BACT*Temp[i]))
ft.metabolism <- exp(RQ*Temp[i])
ACTIVITY <- exp(RTO*VEL)
Respiration[i] <- RA*(cons.wt^RB)*ft.metabolism*ACTIVITY #Units --> Specific (g O2/g/d).
SDAction[i] <- SDA*(Consumption[i]-Egestion[i]) #Units --> Specific (g/g/d)
}
Growth <- ((Consumption*prey.ED) - (((Egestion+Excretion+SDAction)*prey.ED) + (Respiration*OxyConv)))/cons.ED
return(data.frame(Temp, Growth, Consumption, Excretion, Egestion, SDAction, Respiration))
}
#Calculate Temp-dependent Growth curves for different P-value/Prey ED combinations
#Low PreyED = 3700
LowC.3 <- TempGrowth(cons.wt = 10, cons.ED = 4085, pval = 0.3, prey.ED = 3700)
LowC.5 <- TempGrowth(cons.wt = 10, cons.ED = 4085, pval = 0.5, prey.ED = 3700)
LowC.7 <- TempGrowth(cons.wt = 10, cons.ED = 4085, pval = 0.7, prey.ED = 3700)
#Mid PreyED = 4200
MidC.3 <- TempGrowth(cons.wt = 2, cons.ED = 4085, pval = 0.3, prey.ED = 4200)
MidC.5 <- TempGrowth(cons.wt = 2, cons.ED = 4085, pval = 0.5, prey.ED = 4200)
MidC.7 <- TempGrowth(cons.wt = 2, cons.ED = 4085, pval = 0.7, prey.ED = 4200)
#High PreyED = 5200
HighC.3 <- TempGrowth(cons.wt = 10, cons.ED = 4085, pval = 0.3, prey.ED = 5200)
HighC.5 <- TempGrowth(cons.wt = 10, cons.ED = 4085, pval = 0.5, prey.ED = 5200)
HighC.7 <- TempGrowth(cons.wt = 10, cons.ED = 4085, pval = 0.7, prey.ED = 5200)
#Mid PreyED
matplot(x = MidC.3$Temp, y = MidC.3$Growth, pch = 20, type = "o", xlim = c(0,25),
ylim = c(0,0.06), xaxs = "i", yaxs = "i", xaxt = "n", yaxt = "n", col = "blue")
axis(side = 2, at = c(0,0.01,0.02, 0.03, 0.04, 0.05, 0.06))
matplot(x = MidC.5$Temp, y = MidC.5$Growth, pch = 15, type = "o", add = T, col = "green2")
matplot(x = MidC.7$Temp, y = MidC.7$Growth, pch = 17, type = "o", add = T, col = "red")
polygon(x = c(9,9,13,13), y = c(0,0.06,0.06,0), col = (rgb(red = .2, green = .3,
blue = .4, alpha = .4)))
legend("topright", legend = "4200 J/g Diet", bty = "n", cex = 1.3)
mtext(text = "2g Coho Growth Rates", side = 3, line = 1, outer = T, cex = 1.5)
mtext(text = "Growth Rate (g/g*d)", side = 2, line = 2.75, outer = T, cex = 1.2)
mtext(text = expression(paste("Temperature (", degree, "C)")), side = 1, line = 2.75, outer = T, cex = 1.2)
matplot(x = MidC.3$Temp, y = MidC.3$Growth, pch = 20, type = "o", xlim = c(0,25),
ylim = c(0,0.06), xaxs = "i", yaxs = "i", xaxt = "y", yaxt = "n", col = "blue")
matplot(x = MidC.3$Temp, y = MidC.3$Growth, pch = 20, type = "o", xlim = c(0,25),
ylim = c(0,0.06), xaxs = "i", yaxs = "i", xaxt = "y", yaxt = "n", col = "blue")
axis(side = 2, at = c(0,0.01,0.02, 0.03, 0.04, 0.05, 0.06))
matplot(x = MidC.5$Temp, y = MidC.5$Growth, pch = 15, type = "o", add = T, col = "green2")
matplot(x = MidC.7$Temp, y = MidC.7$Growth, pch = 17, type = "o", add = T, col = "red")
polygon(x = c(9,9,13,13), y = c(0,0.06,0.06,0), col = (rgb(red = .2, green = .3,
matplot(x = MidC.3$Temp, y = MidC.3$Growth, pch = 20, type = "o", xlim = c(0,25),
ylim = c(0,0.06), xaxs = "i", yaxs = "i", xaxt = "y", yaxt = "n", col = "blue")
axis(side = 2, at = c(0,0.01,0.02, 0.03, 0.04, 0.05, 0.06))
matplot(x = MidC.5$Temp, y = MidC.5$Growth, pch = 15, type = "o", add = T, col = "green2")
matplot(x = MidC.7$Temp, y = MidC.7$Growth, pch = 17, type = "o", add = T, col = "red")
polygon(x = c(9,9,13,13), y = c(0,0.06,0.06,0), col = (rgb(red = .2, green = .3,
blue = .4, alpha = .4)))
legend("topright", legend = "4200 J/g Diet", bty = "n", cex = 1.3)
matplot(x = MidC.3$Temp, y = MidC.3$Growth, pch = 20, type = "o", xlim = c(0,25),
ylim = c(0,0.06), xaxs = "i", yaxs = "i", xaxt = "n", yaxt = "n", col = "blue")
axis(side = 2, at = c(0,0.01,0.02, 0.03, 0.04, 0.05, 0.06))
matplot(x = MidC.5$Temp, y = MidC.5$Growth, pch = 15, type = "o", add = T, col = "green2")
matplot(x = MidC.7$Temp, y = MidC.7$Growth, pch = 17, type = "o", add = T, col = "red")
polygon(x = c(9,9,13,13), y = c(0,0.06,0.06,0), col = (rgb(red = .2, green = .3,
blue = .4, alpha = .4)))
legend("topright", legend = "4200 J/g Diet", bty = "n", cex = 1.3)
matplot(x = MidC.3$Temp, y = MidC.3$Growth, pch = 20, type = "o", xlim = c(0,25),
ylim = c(0,0.10), xaxs = "i", yaxs = "i", xaxt = "n", yaxt = "n", col = "blue")
axis(side = 2, at = c(0,0.01,0.02, 0.03, 0.04, 0.05, 0.06))
matplot(x = MidC.5$Temp, y = MidC.5$Growth, pch = 15, type = "o", add = T, col = "green2")
matplot(x = MidC.7$Temp, y = MidC.7$Growth, pch = 17, type = "o", add = T, col = "red")
polygon(x = c(9,9,13,13), y = c(0,0.06,0.06,0), col = (rgb(red = .2, green = .3,
blue = .4, alpha = .4)))
legend("topright", legend = "4200 J/g Diet", bty = "n", cex = 1.3)
matplot(x = MidC.3$Temp, y = MidC.3$Growth, pch = 20, type = "o", xlim = c(0,25),
ylim = c(0,0.09), xaxs = "i", yaxs = "i", xaxt = "n", yaxt = "n", col = "blue")
axis(side = 2, at = c(0,0.01,0.02, 0.03, 0.04, 0.05, 0.06))
matplot(x = MidC.5$Temp, y = MidC.5$Growth, pch = 15, type = "o", add = T, col = "green2")
matplot(x = MidC.7$Temp, y = MidC.7$Growth, pch = 17, type = "o", add = T, col = "red")
polygon(x = c(9,9,13,13), y = c(0,0.06,0.06,0), col = (rgb(red = .2, green = .3,
blue = .4, alpha = .4)))
legend("topright", legend = "4200 J/g Diet", bty = "n", cex = 1.3)
matplot(x = MidC.3$Temp, y = MidC.3$Growth, pch = 20, type = "o", xlim = c(0,25),
ylim = c(0,0.09), xaxs = "i", yaxs = "i", xaxt = "n", yaxt = "n", col = "blue")
axis(side = 2, at = c(0,0.01,0.02, 0.03, 0.04, 0.05, 0.06, 0.07, 0.08, 0.09))
matplot(x = MidC.5$Temp, y = MidC.5$Growth, pch = 15, type = "o", add = T, col = "green2")
matplot(x = MidC.7$Temp, y = MidC.7$Growth, pch = 17, type = "o", add = T, col = "red")
polygon(x = c(9,9,13,13), y = c(0,0.06,0.06,0), col = (rgb(red = .2, green = .3,
blue = .4, alpha = .4)))
legend("topright", legend = "4200 J/g Diet", bty = "n", cex = 1.3)
polygon(x = c(9,9,18,18), y = c(0,0.09,0.09,0), col = (rgb(red = .2, green = .3,
blue = .4, alpha = .4)))
axis(side=1, at=c(0:25) )
mtext(text = "2g Coho Growth Rates", side = 3, line = 1, outer = T, cex = 1.5)
mtext(text = "Growth Rate (g/g*d)", side = 2, line = 2.75, outer = T, cex = 1.2)
mtext(text = expression(paste("Temperature (", degree, "C)")), side = 1, line = 2.75, outer = T, cex = 1.2)
#Mid PreyED
matplot(x = MidC.3$Temp, y = MidC.3$Growth, pch = 20, type = "o", xlim = c(0,25),
ylim = c(0,0.09), xaxs = "i", yaxs = "i", xaxt = "n", yaxt = "n", col = "blue")
axis(side = 2, at = c(0,0.01,0.02, 0.03, 0.04, 0.05, 0.06, 0.07, 0.08, 0.09))
axis(side=1, at=c(0:25) )
matplot(x = MidC.5$Temp, y = MidC.5$Growth, pch = 15, type = "o", add = T, col = "green2")
matplot(x = MidC.7$Temp, y = MidC.7$Growth, pch = 17, type = "o", add = T, col = "red")
polygon(x = c(9,9,18,18), y = c(0,0.09,0.09,0), col = (rgb(red = .2, green = .3,
blue = .4, alpha = .4)))
legend("topright", legend = "4200 J/g Diet", bty = "n", cex = 1.3)
mtext(text = "2g Coho Growth Rates", side = 3, line = 1, outer = T, cex = 1.5)
mtext(text = "Growth Rate (g/g*d)", side = 2, line = 2.75, outer = T, cex = 1.2)
mtext(text = expression(paste("Temperature (", degree, "C)")), side = 1, line = 2.75, outer = T, cex = 1.2)
matplot(x = MidC.3$Temp, y = MidC.3$Growth, pch = 20, type = "o", xlim = c(0,25),
ylim = c(0,0.09), xaxs = "i", yaxs = "i", xaxt = "n", yaxt = "n", col = "blue")
axis(side = 2, at = c(0,0.01,0.02, 0.03, 0.04, 0.05, 0.06, 0.07, 0.08, 0.09))
axis(side=1, at=c(0,2,4,6,8,10,12,14,16,18,20,22,24) )
matplot(x = MidC.5$Temp, y = MidC.5$Growth, pch = 15, type = "o", add = T, col = "green2")
matplot(x = MidC.7$Temp, y = MidC.7$Growth, pch = 17, type = "o", add = T, col = "red")
polygon(x = c(9,9,18,18), y = c(0,0.09,0.09,0), col = (rgb(red = .2, green = .3,
blue = .4, alpha = .4)))
legend("topright", legend = "4200 J/g Diet", bty = "n", cex = 1.3)
mtext(text = "2g Coho Growth Rates", side = 3, line = 1, outer = T, cex = 1.5)
mtext(text = "Growth Rate (g/g*d)", side = 2, line = 2.75, outer = T, cex = 1.2)
mtext(text = expression(paste("Temperature (", degree, "C)")), side = 1, line = 2.75, outer = T, cex = 1.2)
files <- list.files(path="Input files for BioE/Church/", pattern="*.txt", full.names=T, recursive=FALSE)
files
Sim.1 <- RUN.FISH.BIOENERGETICS(files, Weight.Initial=.2,
Weight.Final=5.81, Spawning.Day=0, Gonad.Loss=0, Con.Equation=3,
EG.EX.Equation=3, Resp.SDA.Equation=2, Pred.ED.Equation=2)
Sim.1 <- RUN.FISH.BIOENERGETICS("i", Weight.Initial=.2,
Weight.Final=5.81, Spawning.Day=0, Gonad.Loss=0, Con.Equation=3,
EG.EX.Equation=3, Resp.SDA.Equation=2, Pred.ED.Equation=2)
for( i in files){
Sim.1 <- RUN.FISH.BIOENERGETICS("i", Weight.Initial=.2,
Weight.Final=5.81, Spawning.Day=0, Gonad.Loss=0, Con.Equation=3,
EG.EX.Equation=3, Resp.SDA.Equation=2, Pred.ED.Equation=2)
}
for( i in files){
Sim.1 <- RUN.FISH.BIOENERGETICS(i, Weight.Initial=.2,
Weight.Final=5.81, Spawning.Day=0, Gonad.Loss=0, Con.Equation=3,
EG.EX.Equation=3, Resp.SDA.Equation=2, Pred.ED.Equation=2)
}
files.church
files.church <- list.files(path="Input files for BioE/Church/", pattern="*.txt", full.names=T, recursive=FALSE)
files.church<-as.data.frame(files.church)
View(files.church)
files.church[,2]<-c(1:10)
View(files.church)
for( i in 1:10){
Sim.1 <- RUN.FISH.BIOENERGETICS(files.church[i,1], Weight.Initial=.2,
Weight.Final=files.church[i,2], Spawning.Day=0, Gonad.Loss=0, Con.Equation=3,
EG.EX.Equation=3, Resp.SDA.Equation=2, Pred.ED.Equation=2)
}
for( i in 1:10){
Sim.1 <- RUN.FISH.BIOENERGETICS("files.church[i,1]", Weight.Initial=.2,
Weight.Final=files.church[i,2], Spawning.Day=0, Gonad.Loss=0, Con.Equation=3,
EG.EX.Equation=3, Resp.SDA.Equation=2, Pred.ED.Equation=2)
}
for( i in 1:10){
Sim.1 <- RUN.FISH.BIOENERGETICS(as.character(files.church[i,1]), Weight.Initial=.2,
Weight.Final=files.church[i,2], Spawning.Day=0, Gonad.Loss=0, Con.Equation=3,
EG.EX.Equation=3, Resp.SDA.Equation=2, Pred.ED.Equation=2)
}
