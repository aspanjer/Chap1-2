{
    "contents" : "#This r script creates Chinook temperature-dependent growth curves for a given combination of\n#consumer weight, consumer energy density (J/g), feeding  rate (P-value or %Cmax), and prey energy\n#density (J/g).\n\n#Define Chinook-specific parameters:\n#Consumption related parameters (user defined):\nCA <- 0.303 \nCB <- -0.275\nCQ <- 5           \nCTO <- 15         \nCTM <- 20.93         #(Source: Plumb & Moffitt 2015)\nCTL <- 24.05         #(Source: Plumb & Moffitt 2015)\nCK1 <- 0.36          \nCK4 <- 0.53          #(Source: Plumb & Moffitt 2015)  \n\n#Respiration related parameters (user defined):\nRA <- 0.00264 \nRB <- -0.217\nRQ <- 0.06818\nRTO <- 0.0234\nRTM <- 0\nRTL <- 25\nRK1 <- 1\nRK4 <- 0.13\nACT <- 9.7\nBACT <- 0.0405\nSDA <- 0.172\nOxyConv <- 13560 #J/gram of O2 in respiration conversions (Elliot and Davidson 1975).   \n\n#Egestion and excretion parameters (user defined):\nFA <- 0.212 \nFB <- -0.222\nFG <- 0.631\nUA <- 0.0314\nUB <- 0.58\nUG <- -0.299\n\n#Define range of temperatures over which to estimate growth\nTemp <- seq(from = 1, to = 25, by = 1)\n\n#Define function TempGrowth that creates Chinook temperature-dependent growth curves for a given\n#combination of consumer weight (\"cons.wt\"), consumer energy density (\"cons.ED\"; J/g), feeding  \n#rate (\"pval\"; P-value or %Cmax), and prey energy density (\"prey.ED\"; J/g).\nTempGrowth <- function(cons.wt, cons.ED, pval, prey.ED) {\n     #Define empty vector of length (length(Temp)) for growth values at each temperature\n     Growth <- vector(length = length(Temp))\n     #Define empty vector of length (length(Temp)) for consumption values at each temperature\n     Consumption <- vector(length = length(Temp))\n     #Define empty vector of length (length(Temp)) for egestion and excretion values at each \n     #temperature\n     Egestion <- vector(length = length(Temp))\n     Excretion <- vector(length = length(Temp))\n     #Define empty vector of length (length(Temp)) for SDAction and respiration values at each\n     #temperature\n     SDAction <- vector(length = length(Temp))\n     Respiration <- vector(length = length(Temp))\n     #Calculate Consumption at each temperature and store in Consumption vector\n     for(i in 1:length(Temp)) {\n          G1 <- (1/(CTO-CQ))*log((0.98*(1-CK1))/(CK1*0.02))   \n          G2 <- (1/(CTL-CTM))*log((0.98*(1-CK4))/(CK4*0.02)) \n          L1 <- (exp(G1*(Temp[i]-CQ)))\n          L2 <- (exp(G2*(CTL-Temp[i]))) \n          KA <- (CK1*L1)/(1+CK1*(L1 - 1)) \n          KB <- (CK4*L2)/(1+CK4*(L2 - 1))\n          ft.con <- (KA*KB)\n          Consumption[i] <- (CA*cons.wt^CB)*pval*ft.con\n     }\n     #Calculate Egestion at each temperature and store in Egestion and Excretion vectors\n     for (i in 1:length(Temp)) {\n          Egestion[i] <- FA*(Temp[i]^FB)*exp(FG*pval)*Consumption[i]\n          Excretion[i] <- UA*(Temp[i]^UB)*exp(UG*pval)*(Consumption[i]-Egestion[i])\n     }\n     #Calculate SDAction and Respiration values at each temperature and store in SDAction and\n     #Respiration vectors\n     for (i in 1:length(Temp)) {\n          ifelse(Temp[i] > RTL, VEL <- RK1*cons.wt^RK4, VEL <- ACT*(cons.wt^RK4)*exp(BACT*Temp[i]))\n                            ft.metabolism <- exp(RQ*Temp[i])\n    \t                       ACTIVITY <- exp(RTO*VEL)  \n    \t     Respiration[i] <- RA*(cons.wt^RB)*ft.metabolism*ACTIVITY #Units --> Specific (g O2/g/d). \n          SDAction[i] <- SDA*(Consumption[i]-Egestion[i]) #Units --> Specific (g/g/d) \n     }\n     Growth <- ((Consumption*prey.ED) - (((Egestion+Excretion+SDAction)*prey.ED) + (Respiration*OxyConv)))/cons.ED\n     return(data.frame(Temp, Growth, Consumption, Excretion, Egestion, SDAction, Respiration))\n}\n\n#Calculate Temp-dependent Growth curves for different P-value/Prey ED combinations\n     #Low PreyED = 3700\n          LowC.3 <- TempGrowth(cons.wt = 10, cons.ED = 4085, pval = 0.3, prey.ED = 3700)\n          LowC.5 <- TempGrowth(cons.wt = 10, cons.ED = 4085, pval = 0.5, prey.ED = 3700)\n          LowC.7 <- TempGrowth(cons.wt = 10, cons.ED = 4085, pval = 0.7, prey.ED = 3700)\n     #Mid PreyED = 4200\n          MidC.3 <- TempGrowth(cons.wt = 2, cons.ED = 4085, pval = 0.3, prey.ED = 4200)\n          MidC.5 <- TempGrowth(cons.wt = 2, cons.ED = 4085, pval = 0.5, prey.ED = 4200)\n          MidC.7 <- TempGrowth(cons.wt = 2, cons.ED = 4085, pval = 0.7, prey.ED = 4200)\n     #High PreyED = 5200\n          HighC.3 <- TempGrowth(cons.wt = 10, cons.ED = 4085, pval = 0.3, prey.ED = 5200)\n          HighC.5 <- TempGrowth(cons.wt = 10, cons.ED = 4085, pval = 0.5, prey.ED = 5200)\n          HighC.7 <- TempGrowth(cons.wt = 10, cons.ED = 4085, pval = 0.7, prey.ED = 5200)\n\n#Plot Temp-dependent growth curves\npar(mfrow=c(1,1), mar = c(0,0,0,0), oma = c(5,5,4,1), cex.axis = 1.3)\n     #High PreyED\n          matplot(x = HighC.3$Temp, y = HighC.3$Growth, pch = 20, type = \"o\", xlim = c(0,25), \n          ylim = c(0,0.06), xaxs = \"i\", yaxs = \"i\", xaxt = \"n\", yaxt = \"n\", col = \"blue\")\n               axis(side = 2, at = c(0.02, 0.03, 0.04, 0.05, 0.06))\n          \n          matplot(x = HighC.5$Temp, y = HighC.5$Growth, pch = 15, type = \"o\", add = T, \n               col = \"green2\")\n          \n          matplot(x = HighC.7$Temp, y = HighC.7$Growth, pch = 17, type = \"o\", add = T, col = \"red\")\n          \n          polygon(x = c(9,9,13,13), y = c(0,0.06,0.06,0), col = (rgb(red = .2, green = .3, \n               blue = .4, alpha = .4)))\n          \n          legend(\"topright\", legend = \"5200 J/g Diet\", bty = \"n\", cex = 1.3)\n          \n     #Mid PreyED\n          matplot(x = MidC.3$Temp, y = MidC.3$Growth, pch = 20, type = \"o\", xlim = c(0,25), \n          ylim = c(0,0.09), xaxs = \"i\", yaxs = \"i\", xaxt = \"n\", yaxt = \"n\", col = \"blue\")\n               axis(side = 2, at = c(0,0.01,0.02, 0.03, 0.04, 0.05, 0.06, 0.07, 0.08, 0.09))\n               axis(side=1, at=c(0,2,4,6,8,10,12,14,16,18,20,22,24) )\n          matplot(x = MidC.5$Temp, y = MidC.5$Growth, pch = 15, type = \"o\", add = T, col = \"green2\")\n          \n          matplot(x = MidC.7$Temp, y = MidC.7$Growth, pch = 17, type = \"o\", add = T, col = \"red\")\n          \n          polygon(x = c(9,9,18,18), y = c(0,0.09,0.09,0), col = (rgb(red = .2, green = .3, \n               blue = .4, alpha = .4)))\n          \n          legend(\"topright\", legend = \"4200 J/g Diet\", bty = \"n\", cex = 1.3)\n          \n     #Low PreyED\n          matplot(x = LowC.3$Temp, y = LowC.3$Growth, pch = 20, type = \"o\", xlim = c(0,25), \n          ylim = c(0,0.06), xaxs = \"i\", yaxs = \"i\", col = \"blue\")\n               \n          matplot(x = LowC.5$Temp, y = LowC.5$Growth, pch = 15, type = \"o\", add = T, col = \"green2\")\n          \n          matplot(x = LowC.7$Temp, y = LowC.7$Growth, pch = 17, type = \"o\", add = T, col = \"red\")\n          \n          polygon(x = c(9,9,13,13), y = c(0,0.06,0.06,0), col = (rgb(red = .2, green = .3, \n               blue = .4, alpha = .4)))\n          \n          legend(\"topleft\", legend = c(\"70% Cmax\", \"50% Cmax\", \"30% Cmax\"), pch = c(17,15,20),\n          lty = 1, col = c(\"red\", \"green2\", \"blue\"), bty = \"n\", cex = 1.3)\n          \n          legend(\"topright\", legend = \"3700 J/g Diet\", bty = \"n\", cex = 1.3)\n\nmtext(text = \"2g Coho Growth Rates\", side = 3, line = 1, outer = T, cex = 1.5)\nmtext(text = \"Growth Rate (g/g*d)\", side = 2, line = 2.75, outer = T, cex = 1.2)\nmtext(text = expression(paste(\"Temperature (\", degree, \"C)\")), side = 1, line = 2.75, outer = T, cex = 1.2)\n\n\n\n          ",
    "created" : 1475767598184.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3707714456",
    "id" : "112A4C8A",
    "lastKnownWriteTime" : 1475785681,
    "path" : "~/Downloads/Temp Dependent Growth Curves.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 9,
    "source_on_save" : false,
    "type" : "r_source"
}